<!DOCTYPE html>
<html lang="ru">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Halftone Studio</title>
    <link rel="icon" type="image/svg+xml" href="favicon.svg">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gif.js/0.2.0/gif.js"></script>
    <link rel="stylesheet" href="style.css">
</head>

<body class="min-h-screen p-4 md:p-10">

    <div class="max-w-7xl mx-auto">
        <header class="flex flex-col md:flex-row items-center justify-between mb-10 gap-4">
            <div>
                <h1 class="text-3xl font-medium text-[#D0BCFF]">Halftone Studio <span
                        class="text-sm font-normal opacity-50">:D</span></h1>
                <p class="text-sm text-gray-400">Add amazing effects to your images</p>
            </div>
            <div class="flex gap-3 items-center">
                <button onclick="openAboutModal()"
                    class="m3-button border border-gray-600 text-gray-400 px-4 py-2 flex items-center gap-2 hover:border-gray-500 hover:text-gray-300">
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none"
                        stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <circle cx="12" cy="12" r="10"></circle>
                        <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"></path>
                        <line x1="12" y1="17" x2="12.01" y2="17"></line>
                    </svg>
                    <span id="aboutBtnText">О сервисе</span>
                </button>
                <div class="flex bg-[#2B2930] rounded-full p-1">
                    <button onclick="setLang('ru')" id="lang-ru"
                        class="px-3 py-1 rounded-full text-xs transition-colors">RU</button>
                    <button onclick="setLang('en')" id="lang-en"
                        class="px-3 py-1 rounded-full text-xs transition-colors">EN</button>
                </div>
                <input type="file" id="upload" accept="image/*" class="hidden">
                <input type="file" id="videoFile" accept="video/*" class="hidden">
                <button onclick="document.getElementById('upload').click()"
                    class="m3-button m3-button-primary px-6 py-3 flex items-center gap-2">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none"
                        stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4" />
                        <polyline points="17 8 12 3 7 8" />
                        <line x1="12" y1="3" x2="12" y2="15" />
                    </svg>
                    <span id="uploadBtnText">Загрузить</span>
                </button>
                <button onclick="document.getElementById('videoFile').click()"
                    class="m3-button border border-[#49454F] text-gray-300 px-4 py-3 flex items-center gap-2 hover:bg-[#2B2930]">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none"
                        stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <polygon points="23 7 16 12 23 17 23 7" />
                        <rect x="1" y="5" width="15" height="14" rx="2" ry="2" />
                    </svg>
                    <span id="videoBtnText">Видео</span>
                </button>
            </div>
        </header>

        <div class="grid grid-cols-1 lg:grid-cols-12 gap-8">
            <aside class="lg:col-span-4 space-y-6">
                <div class="m3-card p-6 space-y-8">
                    <section>
                        <h2 class="text-sm font-bold text-gray-400 uppercase mb-4 tracking-widest">Визуальный стиль</h2>
                        <div class="grid grid-cols-2 gap-2">
                            <button onclick="setMode('classic')" id="btn-classic"
                                class="mode-btn m3-button border border-[#49454F] py-2 text-sm bg-[#49454F]">Classic</button>
                            <button onclick="setMode('rgb')" id="btn-rgb"
                                class="mode-btn m3-button border border-[#49454F] py-2 text-sm">RGB Dots</button>
                            <button onclick="setMode('led')" id="btn-led"
                                class="mode-btn m3-button border border-[#49454F] py-2 text-sm">LED Glow</button>
                            <button onclick="setMode('squares')" id="btn-squares"
                                class="mode-btn m3-button border border-[#49454F] py-2 text-sm">Blocks</button>
                            <button onclick="setMode('ascii')" id="btn-ascii"
                                class="mode-btn m3-button border border-[#49454F] py-2 text-sm">ASCII Art</button>
                            <button onclick="setMode('duotone')" id="btn-duotone"
                                class="mode-btn m3-button border border-[#49454F] py-2 text-sm">Duotone</button>
                        </div>
                    </section>

                    <section id="duotoneColors" class="space-y-4 hidden">
                        <h2 class="text-sm font-bold text-gray-400 uppercase mb-4 tracking-widest">Цвета Duotone</h2>
                        <div class="flex items-center gap-4">
                            <div class="flex-1">
                                <label class="text-xs text-gray-400 block mb-1">Тени</label>
                                <input type="color" id="duotoneColor1" value="#2e1065"
                                    class="w-full h-10 rounded-lg cursor-pointer">
                            </div>
                            <div class="flex-1">
                                <label class="text-xs text-gray-400 block mb-1">Света</label>
                                <input type="color" id="duotoneColor2" value="#facc15"
                                    class="w-full h-10 rounded-lg cursor-pointer">
                            </div>
                        </div>
                    </section>

                    <section class="space-y-6">
                        <h2 class="text-sm font-bold text-gray-400 uppercase mb-4 tracking-widest">Параметры</h2>

                        <div class="space-y-2">
                            <div class="flex justify-between text-sm">
                                <span>Плотность сетки</span>
                                <span id="resVal" class="text-[#D0BCFF]">12</span>
                            </div>
                            <input type="range" id="resolution" min="6" max="40" value="12" class="w-full">
                        </div>

                        <div class="space-y-2">
                            <div class="flex justify-between text-sm">
                                <span>Размер частиц</span>
                                <span id="radiusVal" class="text-[#D0BCFF]">1.0</span>
                            </div>
                            <input type="range" id="radiusMultiplier" min="0.1" max="2.5" step="0.1" value="1.0"
                                class="w-full">
                        </div>

                        <div class="space-y-2">
                            <div class="flex justify-between text-sm">
                                <span>Контрастность</span>
                                <span id="contrastVal" class="text-[#D0BCFF]">1.2</span>
                            </div>
                            <input type="range" id="contrast" min="0.5" max="3.0" step="0.1" value="1.2" class="w-full">
                        </div>

                        <div class="flex items-center justify-between p-4 bg-[#2B2930] rounded-2xl">
                            <div class="flex flex-col">
                                <span class="text-sm font-medium">Анимация</span>
                                <span class="text-xs text-gray-400">Пульсация точек</span>
                            </div>
                            <label class="relative inline-flex items-center cursor-pointer">
                                <input type="checkbox" id="animateToggle" class="sr-only peer">
                                <div
                                    class="w-11 h-6 bg-gray-700 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-[#D0BCFF]">
                                </div>
                            </label>
                        </div>
                    </section>

                    <div class="pt-4 space-y-3">
                        <button id="downloadBtn"
                            class="w-full m3-button border border-[#D0BCFF] text-[#D0BCFF] py-3 flex items-center justify-center gap-2 hover:bg-[#D0BCFF] hover:text-[#381E72]">
                            <span id="downloadBtnText">Сохранить PNG</span>
                        </button>
                        <button id="exportGifBtn"
                            class="w-full m3-button bg-[#381E72] text-[#D0BCFF] py-3 flex items-center justify-center gap-2">
                            <span id="exportGifBtnText">Экспорт в GIF (Loop)</span>
                        </button>
                        <button id="resetBtn"
                            class="w-full m3-button border border-gray-600 text-gray-400 py-3 flex items-center justify-center gap-2 hover:border-gray-500 hover:text-gray-300">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24"
                                fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                stroke-linejoin="round">
                                <path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8" />
                                <path d="M3 3v5h5" />
                            </svg>
                            <span id="resetBtnText">Сбросить все</span>
                        </button>
                    </div>
                </div>
                <div id="gifProgress" class="hidden m3-card p-4">
                    <div class="text-xs mb-2 flex justify-between">
                        <span id="gifProgressLabel">Генерация GIF...</span>
                        <span id="progressText">0%</span>
                    </div>
                    <div class="w-full bg-gray-800 rounded-full h-1">
                        <div id="progressBar" class="loading-bar rounded-full"></div>
                    </div>
                </div>
                <div id="videoProgress" class="hidden m3-card p-4">
                    <div class="text-xs mb-2 flex justify-between">
                        <span id="videoProgressLabel">Обработка видео...</span>
                        <span id="videoProgressText">0%</span>
                    </div>
                    <div class="w-full bg-gray-800 rounded-full h-1">
                        <div id="videoProgressBar" class="loading-bar rounded-full"></div>
                    </div>
                </div>
                <button id="exportVideoBtn"
                    class="hidden w-full m3-button border border-[#D0BCFF] text-[#D0BCFF] py-3 mt-4 flex items-center justify-center gap-2 hover:bg-[#D0BCFF] hover:text-[#381E72]">
                    <span>Сохранить видео</span>
                </button>
            </aside>

            <main class="lg:col-span-8">
                <div class="canvas-viewport p-4">
                    <canvas id="mainCanvas" class="max-w-full h-auto shadow-2xl"></canvas>
                    <div id="dropZone"
                        class="absolute inset-0 flex flex-col items-center justify-center bg-black/40 backdrop-blur-sm rounded-24 hidden">
                        <p class="text-xl font-medium">Отпустите файл здесь</p>
                    </div>
                </div>
                <div class="mt-6 flex justify-between items-center px-4">
                    <span id="statusText" class="text-xs text-gray-500">Ожидание изображения...</span>
                    <div class="flex gap-4">
                        <div class="flex items-center gap-2 text-[10px] uppercase tracking-widest opacity-40">
                            <div class="w-2 h-2 rounded-full bg-green-500"></div> <span class="gpu-label">GPU
                                Accelerated</span>
                        </div>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <script src="script.js"></script>
    <script src="video.js"></script>

    <!-- About Modal -->
    <div id="aboutModal" class="fixed inset-0 z-50 hidden">
        <div class="absolute inset-0 bg-black/60 backdrop-blur-sm" onclick="closeAboutModal()"></div>
        <div
            class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-full max-w-lg max-h-[90vh] overflow-y-auto">
            <div class="m3-card p-8 mx-4">
                <div class="flex justify-between items-start mb-6">
                    <h2 class="text-2xl font-medium text-[#D0BCFF]" id="aboutTitle">О сервисе</h2>
                    <button onclick="closeAboutModal()" class="text-gray-400 hover:text-white">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                            stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <line x1="18" y1="6" x2="6" y2="18"></line>
                            <line x1="6" y1="6" x2="18" y2="18"></line>
                        </svg>
                    </button>
                </div>

                <div class="space-y-6 text-gray-300">
                    <div>
                        <h3 class="text-[#D0BCFF] font-medium mb-2" id="aboutDescTitle">Что это?</h3>
                        <p class="text-sm leading-relaxed" id="aboutDesc">Halftone Studio - бесплатный инструмент для
                            создания креативных эффектов на основе анализа яркости изображения. Применяйте стили
                            halftone, RGB-точки, LED-эффект, ASCII-арт и многое другое.</p>
                    </div>

                    <div>
                        <h3 class="text-[#D0BCFF] font-medium mb-2" id="aboutHowTitle">Как использовать</h3>
                        <ol class="text-sm space-y-2 list-decimal list-inside">
                            <li id="aboutHow1">Загрузите изображение или видео</li>
                            <li id="aboutHow2">Выберите визуальный стиль</li>
                            <li id="aboutHow3">Настройте параметры сетки и эффектов</li>
                            <li id="aboutHow4">Сохраните результат в PNG, GIF или видео</li>
                        </ol>
                    </div>

                    <div>
                        <h3 class="text-[#D0BCFF] font-medium mb-2" id="aboutDonateTitle">Поддержать автора</h3>
                        <p class="text-sm mb-4" id="aboutDonateDesc">Если инструмент оказался полезным, вы можете
                            поддержать его развитие:</p>
                        <div class="space-y-3 text-sm">
                            <div class="bg-[#2B2930] p-4 rounded-xl">
                                <div class="text-[#D0BCFF] font-medium mb-1">TON</div>
                                <div class="font-mono text-xs break-all">
                                    UQDcHHagd9JOjbzQXNBv8izXtHPK8DxGWfBG757Qu97-bv-Y</div>
                            </div>
                            <div class="bg-[#2B2930] p-4 rounded-xl">
                                <div class="text-[#D0BCFF] font-medium mb-1">SOL</div>
                                <div class="font-mono text-xs break-all">2PJSu4tERkb7oXonMpbTC5UyJXwHMxbu1TugV3td9Swy
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>